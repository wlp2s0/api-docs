(self.webpackChunkdev_rev_docs=self.webpackChunkdev_rev_docs||[]).push([[89],{3905:function(e,t,n){"use strict";n.d(t,{Zo:function(){return d},kt:function(){return m}});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=a.createContext({}),c=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},d=function(e){var t=c(e.components);return a.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},p=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,s=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),p=c(n),m=i,k=p["".concat(s,".").concat(m)]||p[m]||u[m]||r;return n?a.createElement(k,o(o({ref:t},d),{},{components:n})):a.createElement(k,o({ref:t},d))}));function m(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,o=new Array(r);o[0]=p;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:i,o[1]=l;for(var c=2;c<r;c++)o[c]=n[c];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}p.displayName="MDXCreateElement"},8215:function(e,t,n){"use strict";var a=n(7294);t.Z=function(e){var t=e.children,n=e.hidden,i=e.className;return a.createElement("div",{role:"tabpanel",hidden:n,className:i},t)}},5064:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var a=n(7294),i=n(9443);var r=function(){var e=(0,a.useContext)(i.Z);if(null==e)throw new Error('"useUserPreferencesContext" is used outside of "Layout" component.');return e},o=n(6010),l="tabItem_1uMI",s="tabItemActive_2DSg";var c=37,d=39;var u=function(e){var t=e.lazy,n=e.block,i=e.defaultValue,u=e.values,p=e.groupId,m=e.className,k=r(),h=k.tabGroupChoices,f=k.setTabGroupChoices,y=(0,a.useState)(i),N=y[0],v=y[1],g=a.Children.toArray(e.children),b=[];if(null!=p){var C=h[p];null!=C&&C!==N&&u.some((function(e){return e.value===C}))&&v(C)}var I=function(e){var t=e.currentTarget,n=b.indexOf(t),a=u[n].value;v(a),null!=p&&(f(p,a),setTimeout((function(){var e,n,a,i,r,o,l,c;(e=t.getBoundingClientRect(),n=e.top,a=e.left,i=e.bottom,r=e.right,o=window,l=o.innerHeight,c=o.innerWidth,n>=0&&r<=c&&i<=l&&a>=0)||(t.scrollIntoView({block:"center",behavior:"smooth"}),t.classList.add(s),setTimeout((function(){return t.classList.remove(s)}),2e3))}),150))},T=function(e){var t,n;switch(e.keyCode){case d:var a=b.indexOf(e.target)+1;n=b[a]||b[0];break;case c:var i=b.indexOf(e.target)-1;n=b[i]||b[b.length-1]}null==(t=n)||t.focus()};return a.createElement("div",{className:"tabs-container"},a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,o.Z)("tabs",{"tabs--block":n},m)},u.map((function(e){var t=e.value,n=e.label;return a.createElement("li",{role:"tab",tabIndex:N===t?0:-1,"aria-selected":N===t,className:(0,o.Z)("tabs__item",l,{"tabs__item--active":N===t}),key:t,ref:function(e){return b.push(e)},onKeyDown:T,onFocus:I,onClick:I},n)}))),t?(0,a.cloneElement)(g.filter((function(e){return e.props.value===N}))[0],{className:"margin-vert--md"}):a.createElement("div",{className:"margin-vert--md"},g.map((function(e,t){return(0,a.cloneElement)(e,{key:t,hidden:e.props.value!==N})}))))}},9443:function(e,t,n){"use strict";var a=(0,n(7294).createContext)(void 0);t.Z=a},1975:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return c},contentTitle:function(){return d},metadata:function(){return u},toc:function(){return p},default:function(){return k}});var a=n(2122),i=n(9756),r=(n(7294),n(3905)),o=n(5064),l=n(8215),s=["components"],c={sidebar_position:2},d="Initiate your first payment",u={unversionedId:"build-banking-apps/tutorials/initiate-your-first-payment",id:"build-banking-apps/tutorials/initiate-your-first-payment",isDocsHomePage:!1,title:"Initiate your first payment",description:"This tutorial walks you through the steps to initiate a domestic-payment.",source:"@site/docs/build-banking-apps/tutorials/initiate-your-first-payment.md",sourceDirName:"build-banking-apps/tutorials",slug:"/build-banking-apps/tutorials/initiate-your-first-payment",permalink:"/docs/build-banking-apps/tutorials/initiate-your-first-payment",version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"docs",previous:{title:"Get account and transaction information",permalink:"/docs/build-banking-apps/tutorials/get-account-and-transaction-information"},next:{title:"Create your first draft payment",permalink:"/docs/build-banking-apps/tutorials/create-your-first-draft-payment"}},p=[{value:"1. Generate a client credentials token",id:"1-generate-a-client-credentials-token",children:[]},{value:"2. Create a domestic payment consent",id:"2-create-a-domestic-payment-consent",children:[]},{value:"3. Create a JWT URL parameter",id:"3-create-a-jwt-url-parameter",children:[]},{value:"4. Get consent from user",id:"4-get-consent-from-user",children:[]},{value:"5. Exchange authorization code for access token",id:"5-exchange-authorization-code-for-access-token",children:[]},{value:"6. Initiate a domestic payment",id:"6-initiate-a-domestic-payment",children:[]},{value:"What\u2019s next",id:"whats-next",children:[]}],m={toc:p};function k(e){var t=e.components,n=(0,i.Z)(e,s);return(0,r.kt)("wrapper",(0,a.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"initiate-your-first-payment"},"Initiate your first payment"),(0,r.kt)("p",null,"This tutorial walks you through the steps to initiate a ",(0,r.kt)("inlineCode",{parentName:"p"},"domestic-payment"),"."),(0,r.kt)("p",null,"Similar steps apply to all of our payments endpoints. Therefore, after you complete this tutorial, you will know how to use all the payments endpoints."),(0,r.kt)("p",null,"See the ",(0,r.kt)("a",{href:"https://developer.revolut.com/api-reference/open-banking/#tag/Payment-Initiation"},"API Reference")," for all the supported payments."),(0,r.kt)("p",null,"Before you begin, ensure that you have:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Registered your application with the ",(0,r.kt)("inlineCode",{parentName:"li"},"payments")," scope in Developer Portal"),(0,r.kt)("li",{parentName:"ul"},"Obtained a sandbox/production ",(0,r.kt)("inlineCode",{parentName:"li"},"client_id"),"  from Developer Portal"),(0,r.kt)("li",{parentName:"ul"},"Obtained sandbox/production ",(0,r.kt)("inlineCode",{parentName:"li"},"transport.pem")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"signing.pem")," certificates, from Developer Portal or QTSP issuing body"),(0,r.kt)("li",{parentName:"ul"},"Uploaded the ",(0,r.kt)("a",{href:"https://developer.revolut.com/docs/build-banking-apps/#register-your-application-using-dcr-1-get-the-jwks-url"},(0,r.kt)("inlineCode",{parentName:"li"},"jwks_url"))," in Developer Portal that is specific to your ",(0,r.kt)("inlineCode",{parentName:"li"},"transport.pem")," certificate. Ensure that the ",(0,r.kt)("inlineCode",{parentName:"li"},"x5c")," claim is specified.")),(0,r.kt)("div",{class:"feedback"}),(0,r.kt)("h2",{id:"1-generate-a-client-credentials-token"},"1. Generate a client credentials token"),(0,r.kt)("p",null,"Get access token"),(0,r.kt)(o.Z,{defaultValue:"prod",values:[{label:"Production",value:"prod"},{label:"Sandbox",value:"sandbox"}],mdxType:"Tabs"},(0,r.kt)(l.Z,{value:"prod",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"curl --cert transport.pem --key private.key \\\n--location --request POST 'https://oba-auth.revolut.com/token' \\\n--header 'Content-Type: application/x-www-form-urlencoded' \\\n--data-urlencode 'grant_type=client_credentials' \\\n--data-urlencode 'scope=payments' \\\n--data-urlencode 'client_id=<your_client_id>'\n"))),(0,r.kt)(l.Z,{value:"sandbox",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"curl -k --cert transport.pem --key private.key \\\n--location --request POST 'https://sandbox-oba-auth.revolut.com/token' \\\n--header 'Content-Type: application/x-www-form-urlencoded' \\\n--data-urlencode 'grant_type=client_credentials' \\\n--data-urlencode 'scope=payments' \\\n--data-urlencode 'client_id=<your_client_id>'\n")))),(0,r.kt)("p",null,"Response:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "access_token":"eyJhbGciOiJQUzI1NiJ9.eyJjbGllbnRJZCI6IjFlYzFkYjJkLTNlNWItNGQ4Mi1iNDJlLTA2Nzk0NTYyZTIwZSIsInNjb3BlcyI6WyJhY2NvdW50cyJdLCJleHAiOjE2MDQ5MzAzOTh9.pMMtYxYh8_M8P0v9_yfJ29iq3h2x_1RT6BLJPbrJ6SSsai_fQmMNGWXtDapPCSvWtn-ol0aN8Pl725uSSJqWHFxdh0PwvKP1762s5jy7xcLTkb8tgg-AoTPm87-vsnHnw5z63yiDW1Migdx7vDN_jRe3WUSfE-u0Qv7W3SLVo8kB5-qxn2VHZTBSaBr5XReINBHJgh7Xi9LzqxqUh0yCiZSSRnu8o7-I_Q1K0jPK1D7ve7BxlkOb5fSR59CbtzfkZpI6jKDOWSqU_5mftqRRylle382nfS6AeY2eubdH6OS-lJRFcwsYplauE-tZ__54G4LTjPhUWQezvewCc5gq2Q",\n  "token_type":"Bearer",\n  "expires_in":2399\n}\n')),(0,r.kt)("p",null,"Request an access token for client credentials using the ",(0,r.kt)("inlineCode",{parentName:"p"},"/token")," endpoint and the ",(0,r.kt)("inlineCode",{parentName:"p"},"client_credentials")," grant type."),(0,r.kt)("p",null,"You use this token to:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{href:"#manage-your-applications-update-an-application"},"Update your application"),"."),(0,r.kt)("li",{parentName:"ul"},"Create a payment consent in the next step.")),(0,r.kt)("div",{class:"feedback"}),(0,r.kt)("h2",{id:"2-create-a-domestic-payment-consent"},"2. Create a domestic payment consent"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"x-jws-signature")," header:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "alg": "PS256",\n  "kid": "<insert kid>",\n  "crit": ["http://openbanking.org.uk/tan"],\n  "http://openbanking.org.uk/tan": <insert JWKs root domain>\n}\n')),(0,r.kt)("p",null,"Create a consent:"),(0,r.kt)(o.Z,{defaultValue:"prod",values:[{label:"Production",value:"prod"},{label:"Sandbox",value:"sandbox"}],mdxType:"Tabs"},(0,r.kt)(l.Z,{value:"prod",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'curl --location --request POST \'https://oba.revolut.com/domestic-payment-consents\' \\\n--header \'x-fapi-financial-id: 001580000103UAvAAM\' \\\n--header \'Content-Type: application/json\' \\\n--header \'x-idempotency-key: 123\' \\\n--header \'Authorization: Bearer <insert client_credentials token>\' \\\n--header \'x-jws-signature: <insert jws signature>\' \\\n--data \'\n{\n  "Data": {\n    "Initiation": {\n      "InstructionIdentification": "ID412",\n      "EndToEndIdentification": "E2E123",\n      "InstructedAmount": {\n        "Amount": "55.00",\n        "Currency": "GBP"\n      },\n      "CreditorAccount": {\n        "SchemeName": "UK.OBIE.SortCodeAccountNumber",\n        "Identification": "11223321325698",\n        "Name": "Receiver Co."\n      },\n      "RemittanceInformation": {\n        "Reference": "ReceiverRef",\n        "Unstructured": "Shipment fee"\n      }\n    }\n  },\n  "Risk": {\n    "PaymentContextCode": "EcommerceGoods",\n    "MerchantCategoryCode": "5967",\n    "MerchantCustomerIdentification": "1238808123123",\n    "DeliveryAddress": {\n      "AddressLine": ["7"],\n      "StreetName": "Apple Street",\n      "BuildingNumber": "1",\n      "PostCode": "E2 7AA",\n      "TownName": "London",\n      "Country": "UK"\n    }\n  }\n}\n'))),(0,r.kt)(l.Z,{value:"sandbox",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'curl --location --request POST \'https://sandbox-oba.revolut.com/domestic-payment-consents\' \\\n--header \'x-fapi-financial-id: 001580000103UAvAAM\' \\\n--header \'Content-Type: application/json\' \\\n--header \'x-idempotency-key: 123\' \\\n--header \'Authorization: Bearer <insert client_credentials token>\' \\\n--header \'x-jws-signature: <insert jws signature>\' \\\n--data \'\n{\n  "Data": {\n    "Initiation": {\n      "InstructionIdentification": "ID412",\n      "EndToEndIdentification": "E2E123",\n      "InstructedAmount": {\n        "Amount": "55.00",\n        "Currency": "GBP"\n      },\n      "CreditorAccount": {\n        "SchemeName": "UK.OBIE.SortCodeAccountNumber",\n        "Identification": "11223321325698",\n        "Name": "Receiver Co."\n      },\n      "RemittanceInformation": {\n        "Reference": "ReceiverRef",\n        "Unstructured": "Shipment fee"\n      }\n    }\n  },\n  "Risk": {\n    "PaymentContextCode": "EcommerceGoods",\n    "MerchantCategoryCode": "5967",\n    "MerchantCustomerIdentification": "1238808123123",\n    "DeliveryAddress": {\n      "AddressLine": ["7"],\n      "StreetName": "Apple Street",\n      "BuildingNumber": "1",\n      "PostCode": "E2 7AA",\n      "TownName": "London",\n      "Country": "UK"\n    }\n  }\n}\'\n')))),(0,r.kt)("p",null,"Response:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "Data": {\n    "Status": "AwaitingAuthorisation",\n    "StatusUpdateDateTime": "2020-11-20T08:35:53.523806Z",\n    "CreationDateTime": "2020-11-20T08:35:53.523806Z",\n    "ConsentId": "6686e444-c103-4077-8085-8e094200c425",\n    "Initiation": {\n      "InstructionIdentification": "ID412",\n      "EndToEndIdentification": "E2E123",\n      "InstructedAmount": {\n        "Amount": "55.00",\n        "Currency": "GBP"\n      },\n      "CreditorAccount": {\n        "SchemeName": "UK.OBIE.SortCodeAccountNumber",\n        "Identification": "11223321325698",\n        "Name": "ReceiverCo."\n      },\n      "RemittanceInformation": {\n        "Reference": "ReceiverRef",\n        "Unstructured": "Shipmentfee"\n      }\n    }\n  },\n  "Risk": {\n    "PaymentContextCode": "EcommerceGoods",\n    "MerchantCategoryCode": "5967",\n    "MerchantCustomerIdentification": "1238808123123",\n    "DeliveryAddress": {\n      "AddressLine": [\n        "7"\n      ],\n      "StreetName": "AppleStreet",\n      "BuildingNumber": "1",\n      "PostCode": "E27AA",\n      "TownName": "London",\n      "Country": "UK"\n    }\n  },\n  "Links": {\n    "Self": "https://oba.revolut.com/domestic-payment-consents/6686e444-c103-4077-8085-8e094200c425"\n  },\n  "Meta": {\n    "TotalPages": 1\n  }\n}\n')),(0,r.kt)("p",null,"Create a consent to initiate a domestic payment on behalf of a Revolut customer."),(0,r.kt)("p",null,"When you create the consent, ensure that you"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Use your ",(0,r.kt)("inlineCode",{parentName:"li"},"client_credentials")," token from the previous step in the ",(0,r.kt)("inlineCode",{parentName:"li"},"Authorization")," field."),(0,r.kt)("li",{parentName:"ul"},"Pass ",(0,r.kt)("inlineCode",{parentName:"li"},"x-jws-signature header")," in the API request that contains a detached JWS signature of the body of the payload. The signature must be generated from the request body with the TPP signing key that is specified in the JWS header."),(0,r.kt)("li",{parentName:"ul"},"Pass the head and signature in ",(0,r.kt)("inlineCode",{parentName:"li"},"<jws_head>..<jws_signature>")," format."),(0,r.kt)("li",{parentName:"ul"},"Specify the ",(0,r.kt)("inlineCode",{parentName:"li"},"x-idempotency-key")," field so that when there is a network failure and you do not receive the ID from the response, you can retry the request.")),(0,r.kt)("div",{class:"feedback"}),(0,r.kt)("h2",{id:"3-create-a-jwt-url-parameter"},"3. Create a JWT URL parameter"),(0,r.kt)("p",null,"After you create a consent, you need the users to authorize the consent so that you can initiate a payment on their behalf."),(0,r.kt)("p",null,"Header"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "alg": "PS256",\n  "kid": "<insert kid>"\n}\n')),(0,r.kt)("p",null,"Body"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "response_type": "code id_token",\n  "client_id": <insert client_id>,\n  "redirect_uri": <insert redirect_uri>,\n  "scope": "payments",\n  "claims": {\n    "id_token": {\n      "openbanking_intent_id": {\n        "value": <insert ConsentId>\n      }\n    }\n  }\n}\n')),(0,r.kt)("p",null,"Create a JWT request parameter with the header and body format on the right, signed by your signing certificate\u2019s private key. This signature is validated using the JWKs endpoint that you specified during the registration of your application. ",(0,r.kt)("a",{href:"https://jwt.io/"},"jwt.io")," is a helpful tool for debugging JWTs."),(0,r.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"The values of ",(0,r.kt)("code",null,"client_id"),",  ",(0,r.kt)("code",null,"redirect_uri"),", ",(0,r.kt)("code",null,"kid"),", and ",(0,r.kt)("code",null,"scope")," should correspond to those for your specific application and consent request.\nThe value of ",(0,r.kt)("code",null,"openbanking_intent_id")," is the value of the ",(0,r.kt)("code",null,"ConsentId")," field generated from the previous step."))),(0,r.kt)("div",{class:"feedback"}),(0,r.kt)("h2",{id:"4-get-consent-from-user"},"4. Get consent from user"),(0,r.kt)("p",null,"Sample URL:"),(0,r.kt)(o.Z,{defaultValue:"prod",values:[{label:"Production",value:"prod"},{label:"Sandbox",value:"sandbox"}],mdxType:"Tabs"},(0,r.kt)(l.Z,{value:"prod",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"https://oba.revolut.com/ui/index.html?response_type=code%26id_token&scope=accounts&redirect_uri=<insert redirect URL>&client_id=<insert client_id>&request=<insert JWT>\n\n"))),(0,r.kt)(l.Z,{value:"sandbox",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"https://sandbox-oba.revolut.com/ui/index.html?response_type=code%26id_token&scope=payments&redirect_uri=<insert redirect URL>&client_id=<insert client_id>&request=<insert JWT>\n")))),(0,r.kt)("p",null,"Redirect the user to the authorization URL with the following parameters."),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"),(0,r.kt)("th",{parentName:"tr",align:null},"Required"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"response_type")),(0,r.kt)("td",{parentName:"tr",align:null},"Always set to   ",(0,r.kt)("inlineCode",{parentName:"td"},"code&id_token"),"."),(0,r.kt)("td",{parentName:"tr",align:null},"yes")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"client_id")),(0,r.kt)("td",{parentName:"tr",align:null},"The client ID for your application."),(0,r.kt)("td",{parentName:"tr",align:null},"yes")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"redirect_uri")),(0,r.kt)("td",{parentName:"tr",align:null},"One of the redirect URIs that you defined during the application creation."),(0,r.kt)("td",{parentName:"tr",align:null},"yes")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"scope")),(0,r.kt)("td",{parentName:"tr",align:null},"The scope that you are requesting, for example, ",(0,r.kt)("inlineCode",{parentName:"td"},"accounts")," or ",(0,r.kt)("inlineCode",{parentName:"td"},"payments"),"."),(0,r.kt)("td",{parentName:"tr",align:null},"yes")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"request")),(0,r.kt)("td",{parentName:"tr",align:null},"The encoded JWT generated from the previous step."),(0,r.kt)("td",{parentName:"tr",align:null},"yes")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"response_mode")),(0,r.kt)("td",{parentName:"tr",align:null},"If set to ",(0,r.kt)("inlineCode",{parentName:"td"},"fragment")," parameters will be passed in fragment section of redirect URI. Otherwise, parameters are passed in URI query. Passing parameters in fragment is considered to be more secure."),(0,r.kt)("td",{parentName:"tr",align:null},"no")))),(0,r.kt)("p",null,"Sample redirect after successful response"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"https://www.revolut_redirect.com/?code=oa_sand_sPoyVs-oMhyR36j5N-ZEVLfK9rQWPNssgIQqsOFZQ-c&id_token=eyJraWQiOiJxRlFQaTRPVkJVLVNaVk5iMjJ5VjVHQVZDN1UiLCJhbGciOiJQUzI1NiJ9.eyJpc3MiOiJodHRwczovL29iYS5yZXZvbHV0LmNvZGVzIiwiaWF0IjoxNjA0OTM2ODUzLCJzdWIiOiI0NjdiYzg3MC1jOTllLTQ0MzQtYTk1OS1iOGM1NmVlNmEwMjciLCJhY3IiOiJ1cm46b3BlbmJhbmtpbmc6cHNkMjpzY2EiLCJvcGVuYmFua2luZ19pbnRlbnRfaWQiOiI0NjdiYzg3MC1jOTllLTQ0MzQtYTk1OS1iOGM1NmVlNmEwMjciLCJhdWQiOiIxZWMxZGIyZC0zZTViLTRkODItYjQyZS0wNjc5NDU2MmUyMGUiLCJub25jZSI6Im4tMFM2X1d6QTJNaiIsImV4cCI6MTYwNDkzNzQ1MywiY19oYXNoIjoiTXNfRnRwdWs0U2VDNW4zdUNMTTc0ZyIsInNfaGFzaCI6IlM2YVhOY3BUZGw3V3B3bnR0V3h1b2cifQ.m-EvhggqLg7ZXh0we_PLKNsc248p8Bn_o5nj7_6CQHkiRI23ZrYjJLlz_1BhvZ_iY1Tll2gybq_0eSKRgHpvOPnhvCbcSAyfkE8YERZoVkIe-64cyiomhaqBzMzjQyghaL4KrnKH667wR1gTjVhwyJyztalTKidoLZ5OFVWRSHkqW3YLm-_q51wP0k7HHvJ-fnkGcIoCv2TYXpb9xykvgGRJv9KIISbQtM_bLBpo5Q6Q1fxNc-LK2iT-o22xQzLhzvGHtXLTl7Kn5xYf8quDjA5zG0iCAGLJ-Fo9NuTobcKjJOaNYpQ_Y2ilKMmtXqRdgAF_in4Lydt2dn9duxFvJA&state=state\n")),(0,r.kt)("p",null,"On successful completion of the authorization flow, you receive an authorization code (",(0,r.kt)("inlineCode",{parentName:"p"},"code"),") as a URL parameter in the redirect."),(0,r.kt)("p",null,"Check the response example on the right to see what the ",(0,r.kt)("inlineCode",{parentName:"p"},"code")," looks like."),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"The ",(0,r.kt)("code",null,"code")," is valid only for two minutes."))),(0,r.kt)("div",{class:"feedback"}),(0,r.kt)("h2",{id:"5-exchange-authorization-code-for-access-token"},"5. Exchange authorization code for access token"),(0,r.kt)("p",null,"Exchange for access token"),(0,r.kt)(o.Z,{defaultValue:"prod",values:[{label:"Production",value:"prod"},{label:"Sandbox",value:"sandbox"}],mdxType:"Tabs"},(0,r.kt)(l.Z,{value:"prod",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"curl  --key private.key --cert transport.pem \\\n--location --request POST 'https://oba-auth.revolut.com/token' \\\n--header 'Content-Type:application/x-www-form-urlencoded' \\\n--data-urlencode 'grant_type=authorization_code' \\\n--data-urlencode'code=<insert auth_code>'\n"))),(0,r.kt)(l.Z,{value:"sandbox",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"curl -k --key private.key --cert transport.pem \\\n--location --request POST 'https://sandbox-oba-auth.revolut.com/token' \\\n--header 'Content-Type:application/x-www-form-urlencoded' \\\n--data-urlencode 'grant_type=authorization_code' \\\n--data-urlencode 'code=<insert auth_code>'\n")))),(0,r.kt)("p",null,"Response"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "access_token":"oa_sand_tP1Nofi1ixsRfBmVBtVPdIVN0J5x91imqmheQIWTS5s",\n  "token_type":"Bearer",\n  "expires_in":7775999,\n  "id_token":"eyJraWQiOiJxRlFQaTRPVkJVLVNaVk5iMjJ5VjVHQVZDN1UiLCJhbGciOiJQUzI1NiJ9.eyJpc3MiOiJodHRwczovL29iYS5yZXZvbHV0LmNvZGVzIiwic3ViIjoiNDY3YmM4NzAtYzk5ZS00NDM0LWE5NTktYjhjNTZlZTZhMDI3IiwiYXVkIjoiMWVjMWRiMmQtM2U1Yi00ZDgyLWI0MmUtMDY3OTQ1NjJlMjBlIiwibm9uY2UiOiJuLTBTNl9XekEyTWoiLCJleHAiOjE2MDQ5Mzc0Nzk1NjksImlhdCI6MTYwNDkzNjg3OX0.NrcI6qSwmkTC4zhVP7S9Se1RD8Mnwfz5D3RyGp_5CI7MN6-GLqGHnIBNPNzbUBjlmer8ecCvhm0j9tkScT0xDMSZUdMjRyvb7qrsXYTVbj0ogDPthZSe-45tiq3y4oOsIusIwMPFWGHzI2zq_wzxYY8h6QXFIK6TB_oC93jM6J5JEUUQwvDR23ntcCoH_9uNaGM2PXO2ppxhxZiJe92TYcoZFCIMxqrcVxuUYM1VLQ8d7TcpoIDWdOmtOVqDYmblUHyjFpO3IcBHalua0LRGmU3ZuaEv2iG3YzpqV0OMIHFUe9fQ95z_jID4rGIWwxRL6URIdzw6ZSSyxRXKRWNh3g"\n}\n')),(0,r.kt)("p",null,"After the user authorize your consent, you use the ",(0,r.kt)("inlineCode",{parentName:"p"},"/token")," endpoint with ",(0,r.kt)("inlineCode",{parentName:"p"},"grant_type=authorization_code")," to get the access token to use the ",(0,r.kt)("inlineCode",{parentName:"p"},"/domestic-payments")," endpoint."),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"The value of ",(0,r.kt)("code",null,"auth_code")," is the authorization code (",(0,r.kt)("code",null,"code"),") generated from the previous step."))),(0,r.kt)("div",{class:"feedback"}),(0,r.kt)("h2",{id:"6-initiate-a-domestic-payment"},"6. Initiate a domestic payment"),(0,r.kt)("p",null,"Create a domestic payment:"),(0,r.kt)(o.Z,{defaultValue:"prod",values:[{label:"Production",value:"prod"},{label:"Sandbox",value:"sandbox"}],mdxType:"Tabs"},(0,r.kt)(l.Z,{value:"prod",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'curl --location --request POST \'https://oba.revolut.com/domestic-payments\' \\\n--header \'x-fapi-financial-id: 001580000103UAvAAM\' \\\n--header \'Content-Type: application/json\' \\\n--header \'x-idempotency-key: 123\' \\\n--header \'Authorization: Bearer <insert acces_token>\' \\\n--header \'x-jws-signature: <insert jws signature>\' \\\n--data \'\n{\n  "Data": {\n    "ConsentId":<insert consent_id>\n    "Initiation": {\n      "InstructionIdentification": "ID412",\n      "EndToEndIdentification": "E2E123",\n      "InstructedAmount": {\n        "Amount": "55.00",\n        "Currency": "GBP"\n      },\n      "CreditorAccount": {\n        "SchemeName": "UK.OBIE.SortCodeAccountNumber",\n        "Identification": "11223321325698",\n        "Name": "Receiver Co."\n      },\n      "RemittanceInformation": {\n        "Reference": "ReceiverRef",\n        "Unstructured": "Shipment fee"\n      }\n    }\n  },\n  "Risk": {\n    "PaymentContextCode": "EcommerceGoods",\n    "MerchantCategoryCode": "5967",\n    "MerchantCustomerIdentification": "1238808123123",\n    "DeliveryAddress": {\n      "AddressLine": ["7"],\n      "StreetName": "Apple Street",\n      "BuildingNumber": "1",\n      "PostCode": "E2 7AA",\n      "TownName": "London",\n      "Country": "UK"\n    }\n  }\n}\n'))),(0,r.kt)(l.Z,{value:"sandbox",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'curl --location --request POST \'https://sandbox-oba.revolut.com/domestic-payments\' \\\n--header \'x-fapi-financial-id: 001580000103UAvAAM\' \\\n--header \'Content-Type: application/json\' \\\n--header \'x-idempotency-key: 123\' \\\n--header \'Authorization: Bearer <insert acces_token>\' \\\n--header \'x-jws-signature: <insert jws signature>\' \\\n--data \'\n{\n  "Data": {\n    "ConsentId":<insert consent_id>\n    "Initiation": {\n      "InstructionIdentification": "ID412",\n      "EndToEndIdentification": "E2E123",\n      "InstructedAmount": {\n        "Amount": "55.00",\n        "Currency": "GBP"\n      },\n      "CreditorAccount": {\n        "SchemeName": "UK.OBIE.SortCodeAccountNumber",\n        "Identification": "11223321325698",\n        "Name": "Receiver Co."\n      },\n      "RemittanceInformation": {\n        "Reference": "ReceiverRef",\n        "Unstructured": "Shipment fee"\n      }\n    }\n  },\n  "Risk": {\n    "PaymentContextCode": "EcommerceGoods",\n    "MerchantCategoryCode": "5967",\n    "MerchantCustomerIdentification": "1238808123123",\n    "DeliveryAddress": {\n      "AddressLine": ["7"],\n      "StreetName": "Apple Street",\n      "BuildingNumber": "1",\n      "PostCode": "E2 7AA",\n      "TownName": "London",\n      "Country": "UK"\n    }\n  }\n}\n')))),(0,r.kt)("p",null,"Response:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "Data": {\n    "DomesticPaymentId": "dd817a13-3198-48ca-a5dc-f22b09ee82c0",\n    "Status": "AcceptedSettlementInProcess",\n    "StatusUpdateDateTime": "2020-11-20T08:54:30.115047Z",\n    "CreationDateTime": "2020-11-20T08:54:30.115047Z",\n    "ConsentId": "6686e444-c103-4077-8085-8e094200c425",\n    "Initiation": {\n      "CreditorAccount": {\n        "Name": "ReceiverCo.",\n        "SchemeName": "UK.OBIE.SortCodeAccountNumber",\n        "Identification": "11223321325698"\n      },\n      "InstructedAmount": {\n        "Amount": "55.00",\n        "Currency": "GBP"\n      },\n      "RemittanceInformation": {\n        "Reference": "ReceiverRef",\n        "Unstructured": "Shipmentfee"\n      },\n      "EndToEndIdentification": "E2E123",\n      "InstructionIdentification": "ID412"\n    }\n  },\n  "Links": {\n    "Self": "https://oba.revolut.com/domestic-payments/dd817a13-3198-48ca-a5dc-f22b09ee82c0"\n  },\n  "Meta": {\n    "TotalPages": 1\n  }\n}\n\n\n')),(0,r.kt)("p",null,"After you generate this access token, you can initiate a domestic payment on the user's behalf. Make a call to the ",(0,r.kt)("inlineCode",{parentName:"p"},"/domestic-payments")," endpoint to initiate the payment."),(0,r.kt)("p",null,"Congratulations! You have successfully initiated your first payment."),(0,r.kt)("h2",{id:"whats-next"},"What\u2019s next"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"See the ",(0,r.kt)("a",{href:"https://developer.revolut.com/api-reference/open-banking/#tag/Payment-Initiation",target:"_blank"},"API Reference")," for full details on all the supported types of payments."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{href:"#tutorials-create-your-first-draft-payment"},"Create your first draft payment:")," see the tutorial for building your integration to our draft payments endpoints.")),(0,r.kt)("div",{class:"feedback"}))}k.isMDXComponent=!0},6010:function(e,t,n){"use strict";function a(e){var t,n,i="";if("string"==typeof e||"number"==typeof e)i+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=a(e[t]))&&(i&&(i+=" "),i+=n);else for(t in e)e[t]&&(i&&(i+=" "),i+=t);return i}function i(){for(var e,t,n=0,i="";n<arguments.length;)(e=arguments[n++])&&(t=a(e))&&(i&&(i+=" "),i+=t);return i}n.d(t,{Z:function(){return i}})}}]);